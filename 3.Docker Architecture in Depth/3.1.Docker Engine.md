# Docker Engine haqida

Salom va ushbu **Docker Engine** bo‘yicha batafsil darsga xush kelibsiz.  
Men **Mumshad Mannambeth**, ushbu sessiyaning instruktoriman.  
Bu darsda siz **Docker arxitekturasi** haqida chuqur tushunchaga ega bo‘lasiz.  
Biz **Docker** qanday qilib **container**lar yordamida ilovalarni ajratib turishini,  
**Docker Engine**ning ichki ishlash mexanizmini va **containerization**ni ta’minlaydigan texnologiyalarni o‘rganamiz.

---

## Docker Engine komponentlari

**Docker Engine** — bu **Docker** o‘rnatilgan host’da ishlaydigan asosiy komponentdir.  
**Linux host**da **Docker** quyidagi **uchta asosiy komponent**ni o‘rnatadi:

1. **Docker Daemon** – bu fon jarayoni bo‘lib, barcha **Docker object**larni boshqaradi, jumladan:  
   **images**, **containers**, **volumes**, va **networks**.
2. **Docker REST API Server** – bu interfeys orqali ilovalar va **custom tool**lar **Docker Daemon** bilan aloqa qiladi.
3. **Docker CLI** – bu **command-line interface**, ya’ni buyruqlar orqali **container**larni ishga tushirish va boshqarish imkonini beradi.  
   **CLI** **REST API** orqali **Docker Daemon** bilan muloqot qiladi.

E’tiborga molik jihat shundaki, **Docker CLI**ni alohida mashinaga (masalan, **local laptop**) o‘rnatib, masofadagi **Docker Engine**ni boshqarish mumkin.  
Buning uchun siz **remote host** manzili va portini ko‘rsatishingiz kerak bo‘ladi.

---

### Masofaviy Docker Engine bilan aloqa qilish

Masofadagi **Docker Engine** bilan aloqa o‘rnatish uchun quyidagi kabi **-H** opsiyasidan foydalaniladi:

```bash
docker -H=remote-docker-engine:2375 run nginx
```
Masalan, agar sizning masofaviy Docker host’ingiz IP manzili 10.123.2.1 bo‘lsa, buyruq quyidagicha bo‘ladi:
```bash
docker -H=10.123.2.1:2375 run nginx
```

## Containerization with Namespaces

**Namespaces** tushunchasini tushunish — **Docker containers** qanday qilib ilovalarni ajratishini anglash uchun juda muhimdir.  
**Docker** turli xil **namespace** turlaridan foydalanadi, masalan:

- **process IDs**
- **network**
- **mounts**
- va boshqalar

Bu orqali **containers** bir xil **host system**ni baham ko‘rgan bo‘lsalar ham, ular mustaqil tarzda ishlaydi.

## Process ID Namespaces

**Linux system**ning markazida bitta jarayon mavjud bo‘lib, u **process ID (PID)** 1 ga ega — ya’ni **root process**.  
Tizim ishlash jarayonida yangi jarayonlar ishga tushadi va ularga noyob **PIDs** beriladi.  

Container ishga tushirilganda, u o‘zini mustaqil tizim sifatida tutadi va o‘zining **root process (PID 1)** ni yaratadi, garchi bu jarayonlar aslida **host’s process table** ichida bo‘lsa ham.  
**Docker** bu ajratishni ta’minlash uchun **process ID namespaces** dan foydalanadi.

### Container ichidagi jarayonlar (processes) ikki xil ko‘rinishga ega:

1. **Host’s process table** ichidagi haqiqiy PID.  
2. **Container’s namespace** ichidagi noyob PID (1 dan boshlanadi).

Masalan:  
Agar **host** tizimi container ichidagi jarayonlarga **PID 5** va **PID 6** ni ajratgan bo‘lsa, container ichida ular **PID 1** va **PID 2** sifatida ko‘rinadi.


### Misol

Agar siz **NGINX server**ni container ichida ishga tushirsangiz, u yerda xizmat jarayoni **PID 1** sifatida ko‘rinadi (container ichida),  
ammo **host** tizimida bu jarayon boshqacha **PID**ga ega bo‘ladi.

Bu esa shuni ko‘rsatadiki, **containers** umumiy **host resources** dan foydalansalar ham, ular bir-biridan **namespaces** yordamida ajratilgan holda ishlaydi.


## Resource Management with Control Groups (Cgroups)

**Docker hosts** va ularning **containers**lari tizim resurslarini — masalan, **CPU** va **memory**ni — birgalikda ishlatadi.  
Odatiy holatda, har bir **container** barcha mavjud resurslardan foydalanishi mumkin,  
ammo **Docker** bu resurslarni **cheklash** va **boshqarish** uchun **control groups (Cgroups)** texnologiyasidan foydalanadi.


### Misol

Siz **CPU usage**ni **--cpus** opsiyasi yordamida cheklashingiz mumkin.  
Masalan, bu qiymatni `0.5` qilib belgilasangiz, **container** **host** tizimining **CPU** quvvatining **50% dan ortig‘ini** ishlatmaydi.

Xuddi shuningdek, **memory**ni ham cheklash mumkin — buning uchun **--memory** opsiyasidan foydalaniladi.  
Masalan, `100M` qiymati **container**ni **100 megabytes** xotiradan ortiq ishlatishdan to‘xtatadi.

```bash
docker run --cpus=0.5 ubuntu
docker run --memory=100m ubuntu
```

Bu bilan bizning **Docker Engine** haqidagi batafsil muhokamamiz yakuniga yetdi.  
Keyingi darslarda biz **Docker Storage** va **Filesystems** kabi ilg‘or mavzularni o‘rganamiz.  
Docker yordamida **containerization**ni chuqur o‘zlashtirish uchun biz bilan qoling.
